<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Player's Retreat</title>
    <link rel="stylesheet" href="./style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=MedievalSharp&display=swap" rel="stylesheet">
  </head>
  <script src="script.js"></script>
  <body onload="buscarJogos(), validarSessao()">
    <nav class="navbar">
      <div class="logoEspadas">
        <a href="#">
          <img src="https://github.com/nicolas-prates/PI_Forum/blob/main/site/imagens/svgEspadas2.svg?raw=true" alt="Logo da Empresa" />
        </a>
      </div>
      <ul class="menu">
        <li><a href="#">Home</a></li>
        <li><a href="./analytics.html">Analytics</a></li>
        <ul class="dropdown">
          Olá <span id="span_login"></span>
          <li class="dropdown-content" onclick="finalizarSessao()">Log out</li>
        </ul>
      </ul>
    </nav>
    <div class="div_titulo1"><h1>Escolha a Thread</h1></div>
    <section class="section_conteudo">
      <div id="div_conteudo" class="listaJogos1"></div>
    </section>
  </body>
</html>
<script>
  function buscarJogos() {
    var idUsuario = sessionStorage.ID_USUARIO;

    fetch(`/threads/buscar/${idUsuario}`).then(function (resposta) {
      if (resposta.ok) {
        if (resposta.status == 204) {
          console.log("não tem jogos");
          window.location = "./jogos.html";
          
        }

        resposta.json().then(function (resposta) {
          console.log("Dados recebidos: ", JSON.stringify(resposta));

          var tituloMetin2 = 0
          var tituloMuOnline = 0
          var tituloTera = 0
          var tituloNewWorld = 0
          var tituloAlbion = 0
          for (let i = 0; i < resposta.length; i++) {
            var jogo = resposta[i];

            if(jogo.idjogo == 1){
              if(tituloMetin2 == 0){
                div_conteudo.innerHTML += 
                `<div id="metin2" class="listaJogos"><h1>${jogo.nomejogo}</h1></div>`
                  tituloMetin2 ++
              }
              metin2.innerHTML += 
              `<a  href="./listaposts.html?idjogo=${jogo.idjogo}&idtopico=${jogo.idtopico}">${jogo.nometopico}</a><br>`
            }
            if(jogo.idjogo == 2){
              if(tituloMuOnline == 0){
                div_conteudo.innerHTML += 
                `<div id="MuOnline" class="listaJogos"><h1>${jogo.nomejogo}</h1></div>`
                  tituloMuOnline ++
              }
              MuOnline.innerHTML += 
              `<a  href="./listaposts.html?idjogo=${jogo.idjogo}&idtopico=${jogo.idtopico}">${jogo.nometopico}</a><br>`
            }
            if(jogo.idjogo == 3){
              if(tituloTera == 0){
                div_conteudo.innerHTML += 
                `<div id="Tera" class="listaJogos"><h1>${jogo.nomejogo}</h1></div>`
                  tituloTera ++
              }
              Tera.innerHTML += 
              `<a  href="./listaposts.html?idjogo=${jogo.idjogo}&idtopico=${jogo.idtopico}">${jogo.nometopico}</a><br>`
            }
            if(jogo.idjogo == 4){
              if(tituloNewWorld == 0){
                div_conteudo.innerHTML += 
                `<div id="NewWorld" class="listaJogos"><h1>${jogo.nomejogo}</h1></div>`
                  tituloNewWorld ++
              }
              NewWorld.innerHTML += 
              `<a  href="./listaposts.html?idjogo=${jogo.idjogo}&idtopico=${jogo.idtopico}">${jogo.nometopico}</a><br>`
            }
            if(jogo.idjogo == 5){
              if(tituloAlbion == 0){
                div_conteudo.innerHTML += 
                `<div id="Albion" class="listaJogos"><h1>${jogo.nomejogo}</h1></div>`
                  tituloAlbion ++
              }
              Albion.innerHTML += 
              `<a  href="./listaposts.html?idjogo=${jogo.idjogo}&idtopico=${jogo.idtopico}">${jogo.nometopico}</a><br>`
            }
          }
        });
      }
    });
  }
</script>
